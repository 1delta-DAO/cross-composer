import{_ as he,a as G,b as j,c as qe}from"./index-CZyBPvr7.js";var Y={},X=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/constants.js"(V,D){var P=["nodebuffer","arraybuffer","fragments"],u=typeof Blob<"u";u&&P.push("blob"),D.exports={BINARY_TYPES:P,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:u,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}}}),ze=G({"../../node_modules/.pnpm/node-gyp-build@4.8.4/node_modules/node-gyp-build/node-gyp-build.js"(V,D){var P=j("fs"),u=j("path"),W=j("os"),v=typeof __webpack_require__=="function"?__non_webpack_require__:j,N=process.config&&process.config.variables||{},d=!!Y.PREBUILDS_ONLY,i=process.versions.modules,f=L()?"electron":l()?"node-webkit":"node",a=Y.npm_config_arch||W.arch(),m=Y.npm_config_platform||W.platform(),_=Y.LIBC||(C(m)?"musl":"glibc"),B=Y.ARM_VERSION||(a==="arm64"?"8":N.arm_version)||"",p=(process.versions.uv||"").split(".")[0];D.exports=b;function b(y){return v(b.resolve(y))}b.resolve=b.path=function(y){y=u.resolve(y||".");try{var S=v(u.join(y,"package.json")).name.toUpperCase().replace(/-/g,"_");Y[S+"_PREBUILD"]&&(y=Y[S+"_PREBUILD"])}catch{}if(!d){var x=w(u.join(y,"build/Release"),h);if(x)return x;var O=w(u.join(y,"build/Debug"),h);if(O)return O}var $=K(y);if($)return $;var U=K(u.dirname(process.execPath));if(U)return U;var Z=["platform="+m,"arch="+a,"runtime="+f,"abi="+i,"uv="+p,B?"armv="+B:"","libc="+_,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+Z+`
    loaded from: `+y+`
`);function K(J){var ve=R(u.join(J,"prebuilds")).map(c),z=ve.filter(g(m,a)).sort(k)[0];if(z){var ee=u.join(J,"prebuilds",z.name),ye=R(ee).map(e),ge=ye.filter(n(f,i)),ue=ge.sort(s(f))[0];if(ue)return u.join(ee,ue.file)}}};function R(y){try{return P.readdirSync(y)}catch{return[]}}function w(y,S){var x=R(y).filter(S);return x[0]&&u.join(y,x[0])}function h(y){return/\.node$/.test(y)}function c(y){var S=y.split("-");if(S.length===2){var x=S[0],O=S[1].split("+");if(x&&O.length&&O.every(Boolean))return{name:y,platform:x,architectures:O}}}function g(y,S){return function(x){return x==null||x.platform!==y?!1:x.architectures.includes(S)}}function k(y,S){return y.architectures.length-S.architectures.length}function e(y){var S=y.split("."),x=S.pop(),O={file:y,specificity:0};if(x==="node"){for(var $=0;$<S.length;$++){var U=S[$];if(U==="node"||U==="electron"||U==="node-webkit")O.runtime=U;else if(U==="napi")O.napi=!0;else if(U.slice(0,3)==="abi")O.abi=U.slice(3);else if(U.slice(0,2)==="uv")O.uv=U.slice(2);else if(U.slice(0,4)==="armv")O.armv=U.slice(4);else if(U==="glibc"||U==="musl")O.libc=U;else continue;O.specificity++}return O}}function n(y,S){return function(x){return!(x==null||x.runtime&&x.runtime!==y&&!t(x)||x.abi&&x.abi!==S&&!x.napi||x.uv&&x.uv!==p||x.armv&&x.armv!==B||x.libc&&x.libc!==_)}}function t(y){return y.runtime==="node"&&y.napi}function s(y){return function(S,x){return S.runtime!==x.runtime?S.runtime===y?-1:1:S.abi!==x.abi?S.abi?-1:1:S.specificity!==x.specificity?S.specificity>x.specificity?-1:1:0}}function l(){return!!(process.versions&&process.versions.nw)}function L(){return process.versions&&process.versions.electron||Y.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function C(y){return y==="linux"&&P.existsSync("/etc/alpine-release")}b.parseTags=e,b.matchTags=n,b.compareTags=s,b.parseTuple=c,b.matchTuple=g,b.compareTuples=k}}),De=G({"../../node_modules/.pnpm/node-gyp-build@4.8.4/node_modules/node-gyp-build/index.js"(V,D){var P=typeof __webpack_require__=="function"?__non_webpack_require__:j;typeof P.addon=="function"?D.exports=P.addon.bind(P):D.exports=ze()}}),He=G({"../../node_modules/.pnpm/bufferutil@4.0.9/node_modules/bufferutil/fallback.js"(V,D){var P=(W,v,N,d,i)=>{for(var f=0;f<i;f++)N[d+f]=W[f]^v[f&3]},u=(W,v)=>{const N=W.length;for(var d=0;d<N;d++)W[d]^=v[d&3]};D.exports={mask:P,unmask:u}}}),Ye=G({"../../node_modules/.pnpm/bufferutil@4.0.9/node_modules/bufferutil/index.js"(V,D){try{D.exports=De()(__dirname)}catch{D.exports=He()}}}),pe=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/buffer-util.js"(V,D){var{EMPTY_BUFFER:P}=X(),u=Buffer[Symbol.species];function W(f,a){if(f.length===0)return P;if(f.length===1)return f[0];const m=Buffer.allocUnsafe(a);let _=0;for(let B=0;B<f.length;B++){const p=f[B];m.set(p,_),_+=p.length}return _<a?new u(m.buffer,m.byteOffset,_):m}function v(f,a,m,_,B){for(let p=0;p<B;p++)m[_+p]=f[p]^a[p&3]}function N(f,a){for(let m=0;m<f.length;m++)f[m]^=a[m&3]}function d(f){return f.length===f.buffer.byteLength?f.buffer:f.buffer.slice(f.byteOffset,f.byteOffset+f.length)}function i(f){if(i.readOnly=!0,Buffer.isBuffer(f))return f;let a;return f instanceof ArrayBuffer?a=new u(f):ArrayBuffer.isView(f)?a=new u(f.buffer,f.byteOffset,f.byteLength):(a=Buffer.from(f),i.readOnly=!1),a}if(D.exports={concat:W,mask:v,toArrayBuffer:d,toBuffer:i,unmask:N},!Y.WS_NO_BUFFER_UTIL)try{const f=Ye();D.exports.mask=function(a,m,_,B,p){p<48?v(a,m,_,B,p):f.mask(a,m,_,B,p)},D.exports.unmask=function(a,m){a.length<32?N(a,m):f.unmask(a,m)}}catch{}}}),Ke=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/limiter.js"(V,D){var P=Symbol("kDone"),u=Symbol("kRun"),W=class{constructor(v){this[P]=()=>{this.pending--,this[u]()},this.concurrency=v||1/0,this.jobs=[],this.pending=0}add(v){this.jobs.push(v),this[u]()}[u](){if(this.pending!==this.concurrency&&this.jobs.length){const v=this.jobs.shift();this.pending++,v(this[P])}}};D.exports=W}}),me=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/permessage-deflate.js"(V,D){var P=j("zlib"),u=pe(),W=Ke(),{kStatusCode:v}=X(),N=Buffer[Symbol.species],d=Buffer.from([0,0,255,255]),i=Symbol("permessage-deflate"),f=Symbol("total-length"),a=Symbol("callback"),m=Symbol("buffers"),_=Symbol("error"),B,p=class{constructor(h,c,g){if(this._maxPayload=g|0,this._options=h||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!c,this._deflate=null,this._inflate=null,this.params=null,!B){const k=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;B=new W(k)}}static get extensionName(){return"permessage-deflate"}offer(){const h={};return this._options.serverNoContextTakeover&&(h.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(h.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(h.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?h.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(h.client_max_window_bits=!0),h}accept(h){return h=this.normalizeParams(h),this.params=this._isServer?this.acceptAsServer(h):this.acceptAsClient(h),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const h=this._deflate[a];this._deflate.close(),this._deflate=null,h&&h(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(h){const c=this._options,g=h.find(k=>!(c.serverNoContextTakeover===!1&&k.server_no_context_takeover||k.server_max_window_bits&&(c.serverMaxWindowBits===!1||typeof c.serverMaxWindowBits=="number"&&c.serverMaxWindowBits>k.server_max_window_bits)||typeof c.clientMaxWindowBits=="number"&&!k.client_max_window_bits));if(!g)throw new Error("None of the extension offers can be accepted");return c.serverNoContextTakeover&&(g.server_no_context_takeover=!0),c.clientNoContextTakeover&&(g.client_no_context_takeover=!0),typeof c.serverMaxWindowBits=="number"&&(g.server_max_window_bits=c.serverMaxWindowBits),typeof c.clientMaxWindowBits=="number"?g.client_max_window_bits=c.clientMaxWindowBits:(g.client_max_window_bits===!0||c.clientMaxWindowBits===!1)&&delete g.client_max_window_bits,g}acceptAsClient(h){const c=h[0];if(this._options.clientNoContextTakeover===!1&&c.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!c.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(c.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&c.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return c}normalizeParams(h){return h.forEach(c=>{Object.keys(c).forEach(g=>{let k=c[g];if(k.length>1)throw new Error(`Parameter "${g}" must have only a single value`);if(k=k[0],g==="client_max_window_bits"){if(k!==!0){const e=+k;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${g}": ${k}`);k=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${g}": ${k}`)}else if(g==="server_max_window_bits"){const e=+k;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${g}": ${k}`);k=e}else if(g==="client_no_context_takeover"||g==="server_no_context_takeover"){if(k!==!0)throw new TypeError(`Invalid value for parameter "${g}": ${k}`)}else throw new Error(`Unknown parameter "${g}"`);c[g]=k})}),h}decompress(h,c,g){B.add(k=>{this._decompress(h,c,(e,n)=>{k(),g(e,n)})})}compress(h,c,g){B.add(k=>{this._compress(h,c,(e,n)=>{k(),g(e,n)})})}_decompress(h,c,g){const k=this._isServer?"client":"server";if(!this._inflate){const e=`${k}_max_window_bits`,n=typeof this.params[e]!="number"?P.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=P.createInflateRaw({...this._options.zlibInflateOptions,windowBits:n}),this._inflate[i]=this,this._inflate[f]=0,this._inflate[m]=[],this._inflate.on("error",w),this._inflate.on("data",R)}this._inflate[a]=g,this._inflate.write(h),c&&this._inflate.write(d),this._inflate.flush(()=>{const e=this._inflate[_];if(e){this._inflate.close(),this._inflate=null,g(e);return}const n=u.concat(this._inflate[m],this._inflate[f]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[f]=0,this._inflate[m]=[],c&&this.params[`${k}_no_context_takeover`]&&this._inflate.reset()),g(null,n)})}_compress(h,c,g){const k=this._isServer?"server":"client";if(!this._deflate){const e=`${k}_max_window_bits`,n=typeof this.params[e]!="number"?P.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=P.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:n}),this._deflate[f]=0,this._deflate[m]=[],this._deflate.on("data",b)}this._deflate[a]=g,this._deflate.write(h),this._deflate.flush(P.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=u.concat(this._deflate[m],this._deflate[f]);c&&(e=new N(e.buffer,e.byteOffset,e.length-4)),this._deflate[a]=null,this._deflate[f]=0,this._deflate[m]=[],c&&this.params[`${k}_no_context_takeover`]&&this._deflate.reset(),g(null,e)})}};D.exports=p;function b(h){this[m].push(h),this[f]+=h.length}function R(h){if(this[f]+=h.length,this[i]._maxPayload<1||this[f]<=this[i]._maxPayload){this[m].push(h);return}this[_]=new RangeError("Max payload size exceeded"),this[_].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[_][v]=1009,this.removeListener("data",R),this.reset()}function w(h){if(this[i]._inflate=null,this[_]){this[a](this[_]);return}h[v]=1007,this[a](h)}}}),Xe=G({"../../node_modules/.pnpm/utf-8-validate@5.0.10/node_modules/utf-8-validate/fallback.js"(V,D){function P(u){const W=u.length;let v=0;for(;v<W;)if((u[v]&128)===0)v++;else if((u[v]&224)===192){if(v+1===W||(u[v+1]&192)!==128||(u[v]&254)===192)return!1;v+=2}else if((u[v]&240)===224){if(v+2>=W||(u[v+1]&192)!==128||(u[v+2]&192)!==128||u[v]===224&&(u[v+1]&224)===128||u[v]===237&&(u[v+1]&224)===160)return!1;v+=3}else if((u[v]&248)===240){if(v+3>=W||(u[v+1]&192)!==128||(u[v+2]&192)!==128||(u[v+3]&192)!==128||u[v]===240&&(u[v+1]&240)===128||u[v]===244&&u[v+1]>143||u[v]>244)return!1;v+=4}else return!1;return!0}D.exports=P}}),Ze=G({"../../node_modules/.pnpm/utf-8-validate@5.0.10/node_modules/utf-8-validate/index.js"(V,D){try{D.exports=De()(__dirname)}catch{D.exports=Xe()}}}),ce=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/validation.js"(V,D){var{isUtf8:P}=j("buffer"),{hasBlob:u}=X(),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function v(i){return i>=1e3&&i<=1014&&i!==1004&&i!==1005&&i!==1006||i>=3e3&&i<=4999}function N(i){const f=i.length;let a=0;for(;a<f;)if((i[a]&128)===0)a++;else if((i[a]&224)===192){if(a+1===f||(i[a+1]&192)!==128||(i[a]&254)===192)return!1;a+=2}else if((i[a]&240)===224){if(a+2>=f||(i[a+1]&192)!==128||(i[a+2]&192)!==128||i[a]===224&&(i[a+1]&224)===128||i[a]===237&&(i[a+1]&224)===160)return!1;a+=3}else if((i[a]&248)===240){if(a+3>=f||(i[a+1]&192)!==128||(i[a+2]&192)!==128||(i[a+3]&192)!==128||i[a]===240&&(i[a+1]&240)===128||i[a]===244&&i[a+1]>143||i[a]>244)return!1;a+=4}else return!1;return!0}function d(i){return u&&typeof i=="object"&&typeof i.arrayBuffer=="function"&&typeof i.type=="string"&&typeof i.stream=="function"&&(i[Symbol.toStringTag]==="Blob"||i[Symbol.toStringTag]==="File")}if(D.exports={isBlob:d,isValidStatusCode:v,isValidUTF8:N,tokenChars:W},P)D.exports.isValidUTF8=function(i){return i.length<24?N(i):P(i)};else if(!Y.WS_NO_UTF_8_VALIDATE)try{const i=Ze();D.exports.isValidUTF8=function(f){return f.length<32?N(f):i(f)}}catch{}}}),Ie=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/receiver.js"(V,D){var{Writable:P}=j("stream"),u=me(),{BINARY_TYPES:W,EMPTY_BUFFER:v,kStatusCode:N,kWebSocket:d}=X(),{concat:i,toArrayBuffer:f,unmask:a}=pe(),{isValidStatusCode:m,isValidUTF8:_}=ce(),B=Buffer[Symbol.species],p=0,b=1,R=2,w=3,h=4,c=5,g=6,k=class extends P{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||W[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[d]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=p}_write(e,n,t){if(this._opcode===8&&this._state==p)return t();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(t)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new B(t.buffer,t.byteOffset+e,t.length-e),new B(t.buffer,t.byteOffset,e)}const n=Buffer.allocUnsafe(e);do{const t=this._buffers[0],s=n.length-e;e>=t.length?n.set(this._buffers.shift(),s):(n.set(new Uint8Array(t.buffer,t.byteOffset,e),s),this._buffers[0]=new B(t.buffer,t.byteOffset+e,t.length-e)),e-=t.length}while(e>0);return n}startLoop(e){this._loop=!0;do switch(this._state){case p:this.getInfo(e);break;case b:this.getPayloadLength16(e);break;case R:this.getPayloadLength64(e);break;case w:this.getMask();break;case h:this.getData(e);break;case c:case g:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}const n=this.consume(2);if((n[0]&48)!==0){const s=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(s);return}const t=(n[0]&64)===64;if(t&&!this._extensions[u.extensionName]){const s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._fin=(n[0]&128)===128,this._opcode=n[0]&15,this._payloadLength=n[1]&127,this._opcode===0){if(t){const s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(!this._fragmented){const s=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){const s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._compressed=t}else if(this._opcode>7&&this._opcode<11){if(!this._fin){const s=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(s);return}if(t){const s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){const s=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(s);return}}else{const s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(n[1]&128)===128,this._isServer){if(!this._masked){const s=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(s);return}}else if(this._masked){const s=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(s);return}this._payloadLength===126?this._state=b:this._payloadLength===127?this._state=R:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}const n=this.consume(8),t=n.readUInt32BE(0);if(t>Math.pow(2,21)-1){const s=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(s);return}this._payloadLength=t*Math.pow(2,32)+n.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){const n=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(n);return}this._masked?this._state=w:this._state=h}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=h}getData(e){let n=v;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}n=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&a(n,this._mask)}if(this._opcode>7){this.controlMessage(n,e);return}if(this._compressed){this._state=c,this.decompress(n,e);return}n.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(n)),this.dataMessage(e)}decompress(e,n){this._extensions[u.extensionName].decompress(e,this._fin,(s,l)=>{if(s)return n(s);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const L=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");n(L);return}this._fragments.push(l)}this.dataMessage(n),this._state===p&&this.startLoop(n)})}dataMessage(e){if(!this._fin){this._state=p;return}const n=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=i(t,n):this._binaryType==="arraybuffer"?s=f(i(t,n)):this._binaryType==="blob"?s=new Blob(t):s=t,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=p):(this._state=g,setImmediate(()=>{this.emit("message",s,!0),this._state=p,this.startLoop(e)}))}else{const s=i(t,n);if(!this._skipUTF8Validation&&!_(s)){const l=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(l);return}this._state===c||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=p):(this._state=g,setImmediate(()=>{this.emit("message",s,!1),this._state=p,this.startLoop(e)}))}}controlMessage(e,n){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,v),this.end();else{const t=e.readUInt16BE(0);if(!m(t)){const l=this.createError(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");n(l);return}const s=new B(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!_(s)){const l=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");n(l);return}this._loop=!1,this.emit("conclude",t,s),this.end()}this._state=p;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=p):(this._state=g,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=p,this.startLoop(n)}))}createError(e,n,t,s,l){this._loop=!1,this._errored=!0;const L=new e(t?`Invalid WebSocket frame: ${n}`:n);return Error.captureStackTrace(L,this.createError),L.code=l,L[N]=s,L}};D.exports=k}}),We=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/sender.js"(V,D){var{Duplex:P}=j("stream"),{randomFillSync:u}=j("crypto"),W=me(),{EMPTY_BUFFER:v,kWebSocket:N,NOOP:d}=X(),{isBlob:i,isValidStatusCode:f}=ce(),{mask:a,toBuffer:m}=pe(),_=Symbol("kByteLength"),B=Buffer.alloc(4),p=8*1024,b,R=p,w=0,h=1,c=2,g=class Q{constructor(t,s,l){this._extensions=s||{},l&&(this._generateMask=l,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=w,this.onerror=d,this[N]=void 0}static frame(t,s){let l,L=!1,C=2,y=!1;s.mask&&(l=s.maskBuffer||B,s.generateMask?s.generateMask(l):(R===p&&(b===void 0&&(b=Buffer.alloc(p)),u(b,0,p),R=0),l[0]=b[R++],l[1]=b[R++],l[2]=b[R++],l[3]=b[R++]),y=(l[0]|l[1]|l[2]|l[3])===0,C=6);let S;typeof t=="string"?(!s.mask||y)&&s[_]!==void 0?S=s[_]:(t=Buffer.from(t),S=t.length):(S=t.length,L=s.mask&&s.readOnly&&!y);let x=S;S>=65536?(C+=8,x=127):S>125&&(C+=2,x=126);const O=Buffer.allocUnsafe(L?S+C:C);return O[0]=s.fin?s.opcode|128:s.opcode,s.rsv1&&(O[0]|=64),O[1]=x,x===126?O.writeUInt16BE(S,2):x===127&&(O[2]=O[3]=0,O.writeUIntBE(S,4,6)),s.mask?(O[1]|=128,O[C-4]=l[0],O[C-3]=l[1],O[C-2]=l[2],O[C-1]=l[3],y?[O,t]:L?(a(t,l,O,C,S),[O]):(a(t,l,t,0,S),[O,t])):[O,t]}close(t,s,l,L){let C;if(t===void 0)C=v;else{if(typeof t!="number"||!f(t))throw new TypeError("First argument must be a valid error code number");if(s===void 0||!s.length)C=Buffer.allocUnsafe(2),C.writeUInt16BE(t,0);else{const S=Buffer.byteLength(s);if(S>123)throw new RangeError("The message must not be greater than 123 bytes");C=Buffer.allocUnsafe(2+S),C.writeUInt16BE(t,0),typeof s=="string"?C.write(s,2):C.set(s,2)}}const y={[_]:C.length,fin:!0,generateMask:this._generateMask,mask:l,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==w?this.enqueue([this.dispatch,C,!1,y,L]):this.sendFrame(Q.frame(C,y),L)}ping(t,s,l){let L,C;if(typeof t=="string"?(L=Buffer.byteLength(t),C=!1):i(t)?(L=t.size,C=!1):(t=m(t),L=t.length,C=m.readOnly),L>125)throw new RangeError("The data size must not be greater than 125 bytes");const y={[_]:L,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:9,readOnly:C,rsv1:!1};i(t)?this._state!==w?this.enqueue([this.getBlobData,t,!1,y,l]):this.getBlobData(t,!1,y,l):this._state!==w?this.enqueue([this.dispatch,t,!1,y,l]):this.sendFrame(Q.frame(t,y),l)}pong(t,s,l){let L,C;if(typeof t=="string"?(L=Buffer.byteLength(t),C=!1):i(t)?(L=t.size,C=!1):(t=m(t),L=t.length,C=m.readOnly),L>125)throw new RangeError("The data size must not be greater than 125 bytes");const y={[_]:L,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:10,readOnly:C,rsv1:!1};i(t)?this._state!==w?this.enqueue([this.getBlobData,t,!1,y,l]):this.getBlobData(t,!1,y,l):this._state!==w?this.enqueue([this.dispatch,t,!1,y,l]):this.sendFrame(Q.frame(t,y),l)}send(t,s,l){const L=this._extensions[W.extensionName];let C=s.binary?2:1,y=s.compress,S,x;typeof t=="string"?(S=Buffer.byteLength(t),x=!1):i(t)?(S=t.size,x=!1):(t=m(t),S=t.length,x=m.readOnly),this._firstFragment?(this._firstFragment=!1,y&&L&&L.params[L._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(y=S>=L._threshold),this._compress=y):(y=!1,C=0),s.fin&&(this._firstFragment=!0);const O={[_]:S,fin:s.fin,generateMask:this._generateMask,mask:s.mask,maskBuffer:this._maskBuffer,opcode:C,readOnly:x,rsv1:y};i(t)?this._state!==w?this.enqueue([this.getBlobData,t,this._compress,O,l]):this.getBlobData(t,this._compress,O,l):this._state!==w?this.enqueue([this.dispatch,t,this._compress,O,l]):this.dispatch(t,this._compress,O,l)}getBlobData(t,s,l,L){this._bufferedBytes+=l[_],this._state=c,t.arrayBuffer().then(C=>{if(this._socket.destroyed){const S=new Error("The socket was closed while the blob was being read");process.nextTick(k,this,S,L);return}this._bufferedBytes-=l[_];const y=m(C);s?this.dispatch(y,s,l,L):(this._state=w,this.sendFrame(Q.frame(y,l),L),this.dequeue())}).catch(C=>{process.nextTick(e,this,C,L)})}dispatch(t,s,l,L){if(!s){this.sendFrame(Q.frame(t,l),L);return}const C=this._extensions[W.extensionName];this._bufferedBytes+=l[_],this._state=h,C.compress(t,l.fin,(y,S)=>{if(this._socket.destroyed){const x=new Error("The socket was closed while data was being compressed");k(this,x,L);return}this._bufferedBytes-=l[_],this._state=w,l.readOnly=!1,this.sendFrame(Q.frame(S,l),L),this.dequeue()})}dequeue(){for(;this._state===w&&this._queue.length;){const t=this._queue.shift();this._bufferedBytes-=t[3][_],Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[3][_],this._queue.push(t)}sendFrame(t,s){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],s),this._socket.uncork()):this._socket.write(t[0],s)}};D.exports=g;function k(n,t,s){typeof s=="function"&&s(t);for(let l=0;l<n._queue.length;l++){const L=n._queue[l],C=L[L.length-1];typeof C=="function"&&C(t)}}function e(n,t,s){k(n,t,s),n.onerror(t)}}}),Je=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/event-target.js"(V,D){var{kForOnEventAttribute:P,kListener:u}=X(),W=Symbol("kCode"),v=Symbol("kData"),N=Symbol("kError"),d=Symbol("kMessage"),i=Symbol("kReason"),f=Symbol("kTarget"),a=Symbol("kType"),m=Symbol("kWasClean"),_=class{constructor(h){this[f]=null,this[a]=h}get target(){return this[f]}get type(){return this[a]}};Object.defineProperty(_.prototype,"target",{enumerable:!0}),Object.defineProperty(_.prototype,"type",{enumerable:!0});var B=class extends _{constructor(h,c={}){super(h),this[W]=c.code===void 0?0:c.code,this[i]=c.reason===void 0?"":c.reason,this[m]=c.wasClean===void 0?!1:c.wasClean}get code(){return this[W]}get reason(){return this[i]}get wasClean(){return this[m]}};Object.defineProperty(B.prototype,"code",{enumerable:!0}),Object.defineProperty(B.prototype,"reason",{enumerable:!0}),Object.defineProperty(B.prototype,"wasClean",{enumerable:!0});var p=class extends _{constructor(h,c={}){super(h),this[N]=c.error===void 0?null:c.error,this[d]=c.message===void 0?"":c.message}get error(){return this[N]}get message(){return this[d]}};Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});var b=class extends _{constructor(h,c={}){super(h),this[v]=c.data===void 0?null:c.data}get data(){return this[v]}};Object.defineProperty(b.prototype,"data",{enumerable:!0});var R={addEventListener(h,c,g={}){for(const e of this.listeners(h))if(!g[P]&&e[u]===c&&!e[P])return;let k;if(h==="message")k=function(n,t){const s=new b("message",{data:t?n:n.toString()});s[f]=this,w(c,this,s)};else if(h==="close")k=function(n,t){const s=new B("close",{code:n,reason:t.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});s[f]=this,w(c,this,s)};else if(h==="error")k=function(n){const t=new p("error",{error:n,message:n.message});t[f]=this,w(c,this,t)};else if(h==="open")k=function(){const n=new _("open");n[f]=this,w(c,this,n)};else return;k[P]=!!g[P],k[u]=c,g.once?this.once(h,k):this.on(h,k)},removeEventListener(h,c){for(const g of this.listeners(h))if(g[u]===c&&!g[P]){this.removeListener(h,g);break}}};D.exports={CloseEvent:B,ErrorEvent:p,Event:_,EventTarget:R,MessageEvent:b};function w(h,c,g){typeof h=="object"&&h.handleEvent?h.handleEvent.call(h,g):h.call(c,g)}}}),Me=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/extension.js"(V,D){var{tokenChars:P}=ce();function u(N,d,i){N[d]===void 0?N[d]=[i]:N[d].push(i)}function W(N){const d=Object.create(null);let i=Object.create(null),f=!1,a=!1,m=!1,_,B,p=-1,b=-1,R=-1,w=0;for(;w<N.length;w++)if(b=N.charCodeAt(w),_===void 0)if(R===-1&&P[b]===1)p===-1&&(p=w);else if(w!==0&&(b===32||b===9))R===-1&&p!==-1&&(R=w);else if(b===59||b===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${w}`);R===-1&&(R=w);const c=N.slice(p,R);b===44?(u(d,c,i),i=Object.create(null)):_=c,p=R=-1}else throw new SyntaxError(`Unexpected character at index ${w}`);else if(B===void 0)if(R===-1&&P[b]===1)p===-1&&(p=w);else if(b===32||b===9)R===-1&&p!==-1&&(R=w);else if(b===59||b===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${w}`);R===-1&&(R=w),u(i,N.slice(p,R),!0),b===44&&(u(d,_,i),i=Object.create(null),_=void 0),p=R=-1}else if(b===61&&p!==-1&&R===-1)B=N.slice(p,w),p=R=-1;else throw new SyntaxError(`Unexpected character at index ${w}`);else if(a){if(P[b]!==1)throw new SyntaxError(`Unexpected character at index ${w}`);p===-1?p=w:f||(f=!0),a=!1}else if(m)if(P[b]===1)p===-1&&(p=w);else if(b===34&&p!==-1)m=!1,R=w;else if(b===92)a=!0;else throw new SyntaxError(`Unexpected character at index ${w}`);else if(b===34&&N.charCodeAt(w-1)===61)m=!0;else if(R===-1&&P[b]===1)p===-1&&(p=w);else if(p!==-1&&(b===32||b===9))R===-1&&(R=w);else if(b===59||b===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${w}`);R===-1&&(R=w);let c=N.slice(p,R);f&&(c=c.replace(/\\/g,""),f=!1),u(i,B,c),b===44&&(u(d,_,i),i=Object.create(null),_=void 0),B=void 0,p=R=-1}else throw new SyntaxError(`Unexpected character at index ${w}`);if(p===-1||m||b===32||b===9)throw new SyntaxError("Unexpected end of input");R===-1&&(R=w);const h=N.slice(p,R);return _===void 0?u(d,h,i):(B===void 0?u(i,h,!0):f?u(i,B,h.replace(/\\/g,"")):u(i,B,h),u(d,_,i)),d}function v(N){return Object.keys(N).map(d=>{let i=N[d];return Array.isArray(i)||(i=[i]),i.map(f=>[d].concat(Object.keys(f).map(a=>{let m=f[a];return Array.isArray(m)||(m=[m]),m.map(_=>_===!0?a:`${a}=${_}`).join("; ")})).join("; ")).join(", ")}).join(", ")}D.exports={format:v,parse:W}}}),be=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/websocket.js"(V,D){var P=j("events"),u=j("https"),W=j("http"),v=j("net"),N=j("tls"),{randomBytes:d,createHash:i}=j("crypto"),{Duplex:f,Readable:a}=j("stream"),{URL:m}=j("url"),_=me(),B=Ie(),p=We(),{isBlob:b}=ce(),{BINARY_TYPES:R,EMPTY_BUFFER:w,GUID:h,kForOnEventAttribute:c,kListener:g,kStatusCode:k,kWebSocket:e,NOOP:n}=X(),{EventTarget:{addEventListener:t,removeEventListener:s}}=Je(),{format:l,parse:L}=Me(),{toBuffer:C}=pe(),y=30*1e3,S=Symbol("kAborted"),x=[8,13],O=["CONNECTING","OPEN","CLOSING","CLOSED"],$=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,U=class F extends P{constructor(o,T,I){super(),this._binaryType=R[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=w,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=F.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,o!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,T===void 0?T=[]:Array.isArray(T)||(typeof T=="object"&&T!==null?(I=T,T=[]):T=[T]),Z(this,o,T,I)):(this._autoPong=I.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(o){R.includes(o)&&(this._binaryType=o,this._receiver&&(this._receiver._binaryType=o))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(o,T,I){const E=new B({allowSynchronousEvents:I.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:I.maxPayload,skipUTF8Validation:I.skipUTF8Validation}),A=new p(o,this._extensions,I.generateMask);this._receiver=E,this._sender=A,this._socket=o,E[e]=this,A[e]=this,o[e]=this,E.on("conclude",ye),E.on("drain",ge),E.on("error",ue),E.on("message",je),E.on("ping",Fe),E.on("pong",$e),A.onerror=Ge,o.setTimeout&&o.setTimeout(0),o.setNoDelay&&o.setNoDelay(),T.length>0&&o.unshift(T),o.on("close",Oe),o.on("data",de),o.on("end",Te),o.on("error",Ce),this._readyState=F.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=F.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[_.extensionName]&&this._extensions[_.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=F.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(o,T){if(this.readyState!==F.CLOSED){if(this.readyState===F.CONNECTING){z(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===F.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=F.CLOSING,this._sender.close(o,T,!this._isServer,I=>{I||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),ke(this)}}pause(){this.readyState===F.CONNECTING||this.readyState===F.CLOSED||(this._paused=!0,this._socket.pause())}ping(o,T,I){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof o=="function"?(I=o,o=T=void 0):typeof T=="function"&&(I=T,T=void 0),typeof o=="number"&&(o=o.toString()),this.readyState!==F.OPEN){ee(this,o,I);return}T===void 0&&(T=!this._isServer),this._sender.ping(o||w,T,I)}pong(o,T,I){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof o=="function"?(I=o,o=T=void 0):typeof T=="function"&&(I=T,T=void 0),typeof o=="number"&&(o=o.toString()),this.readyState!==F.OPEN){ee(this,o,I);return}T===void 0&&(T=!this._isServer),this._sender.pong(o||w,T,I)}resume(){this.readyState===F.CONNECTING||this.readyState===F.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(o,T,I){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof T=="function"&&(I=T,T={}),typeof o=="number"&&(o=o.toString()),this.readyState!==F.OPEN){ee(this,o,I);return}const E={binary:typeof o!="string",mask:!this._isServer,compress:!0,fin:!0,...T};this._extensions[_.extensionName]||(E.compress=!1),this._sender.send(o||w,E,I)}terminate(){if(this.readyState!==F.CLOSED){if(this.readyState===F.CONNECTING){z(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=F.CLOSING,this._socket.destroy())}}};Object.defineProperty(U,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(U.prototype,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(U,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(U.prototype,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(U,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(U.prototype,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(U,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),Object.defineProperty(U.prototype,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(U.prototype,r,{enumerable:!0})}),["open","error","close","message"].forEach(r=>{Object.defineProperty(U.prototype,`on${r}`,{enumerable:!0,get(){for(const o of this.listeners(r))if(o[c])return o[g];return null},set(o){for(const T of this.listeners(r))if(T[c]){this.removeListener(r,T);break}typeof o=="function"&&this.addEventListener(r,o,{[c]:!0})}})}),U.prototype.addEventListener=t,U.prototype.removeEventListener=s,D.exports=U;function Z(r,o,T,I){const E={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:x[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...I,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(r._autoPong=E.autoPong,!x.includes(E.protocolVersion))throw new RangeError(`Unsupported protocol version: ${E.protocolVersion} (supported versions: ${x.join(", ")})`);let A;if(o instanceof m)A=o;else try{A=new m(o)}catch{throw new SyntaxError(`Invalid URL: ${o}`)}A.protocol==="http:"?A.protocol="ws:":A.protocol==="https:"&&(A.protocol="wss:"),r._url=A.href;const te=A.protocol==="wss:",re=A.protocol==="ws+unix:";let ne;if(A.protocol!=="ws:"&&!te&&!re?ne=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`:re&&!A.pathname?ne="The URL's pathname is empty":A.hash&&(ne="The URL contains a fragment identifier"),ne){const M=new SyntaxError(ne);if(r._redirects===0)throw M;K(r,M);return}const Le=te?443:80,Ne=d(16).toString("base64"),Pe=te?u.request:W.request,oe=new Set;let ae;if(E.createConnection=E.createConnection||(te?ve:J),E.defaultPort=E.defaultPort||Le,E.port=A.port||Le,E.host=A.hostname.startsWith("[")?A.hostname.slice(1,-1):A.hostname,E.headers={...E.headers,"Sec-WebSocket-Version":E.protocolVersion,"Sec-WebSocket-Key":Ne,Connection:"Upgrade",Upgrade:"websocket"},E.path=A.pathname+A.search,E.timeout=E.handshakeTimeout,E.perMessageDeflate&&(ae=new _(E.perMessageDeflate!==!0?E.perMessageDeflate:{},!1,E.maxPayload),E.headers["Sec-WebSocket-Extensions"]=l({[_.extensionName]:ae.offer()})),T.length){for(const M of T){if(typeof M!="string"||!$.test(M)||oe.has(M))throw new SyntaxError("An invalid or duplicated subprotocol was specified");oe.add(M)}E.headers["Sec-WebSocket-Protocol"]=T.join(",")}if(E.origin&&(E.protocolVersion<13?E.headers["Sec-WebSocket-Origin"]=E.origin:E.headers.Origin=E.origin),(A.username||A.password)&&(E.auth=`${A.username}:${A.password}`),re){const M=E.path.split(":");E.socketPath=M[0],E.path=M[1]}let q;if(E.followRedirects){if(r._redirects===0){r._originalIpc=re,r._originalSecure=te,r._originalHostOrSocketPath=re?E.socketPath:A.host;const M=I&&I.headers;if(I={...I,headers:{}},M)for(const[H,se]of Object.entries(M))I.headers[H.toLowerCase()]=se}else if(r.listenerCount("redirect")===0){const M=re?r._originalIpc?E.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:A.host===r._originalHostOrSocketPath;(!M||r._originalSecure&&!te)&&(delete E.headers.authorization,delete E.headers.cookie,M||delete E.headers.host,E.auth=void 0)}E.auth&&!I.headers.authorization&&(I.headers.authorization="Basic "+Buffer.from(E.auth).toString("base64")),q=r._req=Pe(E),r._redirects&&r.emit("redirect",r.url,q)}else q=r._req=Pe(E);E.timeout&&q.on("timeout",()=>{z(r,q,"Opening handshake has timed out")}),q.on("error",M=>{q===null||q[S]||(q=r._req=null,K(r,M))}),q.on("response",M=>{const H=M.headers.location,se=M.statusCode;if(H&&E.followRedirects&&se>=300&&se<400){if(++r._redirects>E.maxRedirects){z(r,q,"Maximum redirects exceeded");return}q.abort();let le;try{le=new m(H,o)}catch{const ie=new SyntaxError(`Invalid URL: ${H}`);K(r,ie);return}Z(r,le,T,I)}else r.emit("unexpected-response",q,M)||z(r,q,`Unexpected server response: ${M.statusCode}`)}),q.on("upgrade",(M,H,se)=>{if(r.emit("upgrade",M),r.readyState!==U.CONNECTING)return;q=r._req=null;const le=M.headers.upgrade;if(le===void 0||le.toLowerCase()!=="websocket"){z(r,H,"Invalid Upgrade header");return}const Be=i("sha1").update(Ne+h).digest("base64");if(M.headers["sec-websocket-accept"]!==Be){z(r,H,"Invalid Sec-WebSocket-Accept header");return}const ie=M.headers["sec-websocket-protocol"];let fe;if(ie!==void 0?oe.size?oe.has(ie)||(fe="Server sent an invalid subprotocol"):fe="Server sent a subprotocol but none was requested":oe.size&&(fe="Server sent no subprotocol"),fe){z(r,H,fe);return}ie&&(r._protocol=ie);const Re=M.headers["sec-websocket-extensions"];if(Re!==void 0){if(!ae){z(r,H,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Se;try{Se=L(Re)}catch{z(r,H,"Invalid Sec-WebSocket-Extensions header");return}const Ue=Object.keys(Se);if(Ue.length!==1||Ue[0]!==_.extensionName){z(r,H,"Server indicated an extension that was not requested");return}try{ae.accept(Se[_.extensionName])}catch{z(r,H,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[_.extensionName]=ae}r.setSocket(H,se,{allowSynchronousEvents:E.allowSynchronousEvents,generateMask:E.generateMask,maxPayload:E.maxPayload,skipUTF8Validation:E.skipUTF8Validation})}),E.finishRequest?E.finishRequest(q,r):q.end()}function K(r,o){r._readyState=U.CLOSING,r._errorEmitted=!0,r.emit("error",o),r.emitClose()}function J(r){return r.path=r.socketPath,v.connect(r)}function ve(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=v.isIP(r.host)?"":r.host),N.connect(r)}function z(r,o,T){r._readyState=U.CLOSING;const I=new Error(T);Error.captureStackTrace(I,z),o.setHeader?(o[S]=!0,o.abort(),o.socket&&!o.socket.destroyed&&o.socket.destroy(),process.nextTick(K,r,I)):(o.destroy(I),o.once("error",r.emit.bind(r,"error")),o.once("close",r.emitClose.bind(r)))}function ee(r,o,T){if(o){const I=b(o)?o.size:C(o).length;r._socket?r._sender._bufferedBytes+=I:r._bufferedAmount+=I}if(T){const I=new Error(`WebSocket is not open: readyState ${r.readyState} (${O[r.readyState]})`);process.nextTick(T,I)}}function ye(r,o){const T=this[e];T._closeFrameReceived=!0,T._closeMessage=o,T._closeCode=r,T._socket[e]!==void 0&&(T._socket.removeListener("data",de),process.nextTick(we,T._socket),r===1005?T.close():T.close(r,o))}function ge(){const r=this[e];r.isPaused||r._socket.resume()}function ue(r){const o=this[e];o._socket[e]!==void 0&&(o._socket.removeListener("data",de),process.nextTick(we,o._socket),o.close(r[k])),o._errorEmitted||(o._errorEmitted=!0,o.emit("error",r))}function xe(){this[e].emitClose()}function je(r,o){this[e].emit("message",r,o)}function Fe(r){const o=this[e];o._autoPong&&o.pong(r,!this._isServer,n),o.emit("ping",r)}function $e(r){this[e].emit("pong",r)}function we(r){r.resume()}function Ge(r){const o=this[e];o.readyState!==U.CLOSED&&(o.readyState===U.OPEN&&(o._readyState=U.CLOSING,ke(o)),this._socket.end(),o._errorEmitted||(o._errorEmitted=!0,o.emit("error",r)))}function ke(r){r._closeTimer=setTimeout(r._socket.destroy.bind(r._socket),y)}function Oe(){const r=this[e];this.removeListener("close",Oe),this.removeListener("data",de),this.removeListener("end",Te),r._readyState=U.CLOSING;let o;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(o=r._socket.read())!==null&&r._receiver.write(o),r._receiver.end(),this[e]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",xe),r._receiver.on("finish",xe))}function de(r){this[e]._receiver.write(r)||this.pause()}function Te(){const r=this[e];r._readyState=U.CLOSING,r._receiver.end(),this.end()}function Ce(){const r=this[e];this.removeListener("error",Ce),this.on("error",n),r&&(r._readyState=U.CLOSING,this.destroy())}}}),Qe=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/stream.js"(V,D){be();var{Duplex:P}=j("stream");function u(d){d.emit("close")}function W(){!this.destroyed&&this._writableState.finished&&this.destroy()}function v(d){this.removeListener("error",v),this.destroy(),this.listenerCount("error")===0&&this.emit("error",d)}function N(d,i){let f=!0;const a=new P({...i,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return d.on("message",function(_,B){const p=!B&&a._readableState.objectMode?_.toString():_;a.push(p)||d.pause()}),d.once("error",function(_){a.destroyed||(f=!1,a.destroy(_))}),d.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(m,_){if(d.readyState===d.CLOSED){_(m),process.nextTick(u,a);return}let B=!1;d.once("error",function(b){B=!0,_(b)}),d.once("close",function(){B||_(m),process.nextTick(u,a)}),f&&d.terminate()},a._final=function(m){if(d.readyState===d.CONNECTING){d.once("open",function(){a._final(m)});return}d._socket!==null&&(d._socket._writableState.finished?(m(),a._readableState.endEmitted&&a.destroy()):(d._socket.once("finish",function(){m()}),d.close()))},a._read=function(){d.isPaused&&d.resume()},a._write=function(m,_,B){if(d.readyState===d.CONNECTING){d.once("open",function(){a._write(m,_,B)});return}d.send(m,B)},a.on("end",W),a.on("error",v),a}D.exports=N}}),et=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/subprotocol.js"(V,D){var{tokenChars:P}=ce();function u(W){const v=new Set;let N=-1,d=-1,i=0;for(i;i<W.length;i++){const a=W.charCodeAt(i);if(d===-1&&P[a]===1)N===-1&&(N=i);else if(i!==0&&(a===32||a===9))d===-1&&N!==-1&&(d=i);else if(a===44){if(N===-1)throw new SyntaxError(`Unexpected character at index ${i}`);d===-1&&(d=i);const m=W.slice(N,d);if(v.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);v.add(m),N=d=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(N===-1||d!==-1)throw new SyntaxError("Unexpected end of input");const f=W.slice(N,i);if(v.has(f))throw new SyntaxError(`The "${f}" subprotocol is duplicated`);return v.add(f),v}D.exports={parse:u}}}),tt=G({"../../node_modules/.pnpm/ws@8.18.3_bufferutil@4.0.9_utf-8-validate@5.0.10/node_modules/ws/lib/websocket-server.js"(V,D){var P=j("events"),u=j("http"),{Duplex:W}=j("stream"),{createHash:v}=j("crypto"),N=Me(),d=me(),i=et(),f=be(),{GUID:a,kWebSocket:m}=X(),_=/^[+/0-9A-Za-z]{22}==$/,B=0,p=1,b=2,R=class extends P{constructor(e,n){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:f,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=u.createServer((t,s)=>{const l=u.STATUS_CODES[426];s.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),s.end(l)}),this._server.listen(e.port,e.host,e.backlog,n)):e.server&&(this._server=e.server),this._server){const t=this.emit.bind(this,"connection");this._removeListeners=w(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(s,l,L)=>{this.handleUpgrade(s,l,L,t)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=B}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===b){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(h,this);return}if(e&&this.once("close",e),this._state!==p)if(this._state=p,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(h,this):process.nextTick(h,this);else{const n=this._server;this._removeListeners(),this._removeListeners=this._server=null,n.close(()=>{h(this)})}}shouldHandle(e){if(this.options.path){const n=e.url.indexOf("?");if((n!==-1?e.url.slice(0,n):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,n,t,s){n.on("error",c);const l=e.headers["sec-websocket-key"],L=e.headers.upgrade,C=+e.headers["sec-websocket-version"];if(e.method!=="GET"){k(this,e,n,405,"Invalid HTTP method");return}if(L===void 0||L.toLowerCase()!=="websocket"){k(this,e,n,400,"Invalid Upgrade header");return}if(l===void 0||!_.test(l)){k(this,e,n,400,"Missing or invalid Sec-WebSocket-Key header");return}if(C!==13&&C!==8){k(this,e,n,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){g(n,400);return}const y=e.headers["sec-websocket-protocol"];let S=new Set;if(y!==void 0)try{S=i.parse(y)}catch{k(this,e,n,400,"Invalid Sec-WebSocket-Protocol header");return}const x=e.headers["sec-websocket-extensions"],O={};if(this.options.perMessageDeflate&&x!==void 0){const $=new d(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const U=N.parse(x);U[d.extensionName]&&($.accept(U[d.extensionName]),O[d.extensionName]=$)}catch{k(this,e,n,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){const $={origin:e.headers[`${C===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient($,(U,Z,K,J)=>{if(!U)return g(n,Z||401,K,J);this.completeUpgrade(O,l,S,e,n,t,s)});return}if(!this.options.verifyClient($))return g(n,401)}this.completeUpgrade(O,l,S,e,n,t,s)}completeUpgrade(e,n,t,s,l,L,C){if(!l.readable||!l.writable)return l.destroy();if(l[m])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>B)return g(l,503);const S=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${v("sha1").update(n+a).digest("base64")}`],x=new this.options.WebSocket(null,void 0,this.options);if(t.size){const O=this.options.handleProtocols?this.options.handleProtocols(t,s):t.values().next().value;O&&(S.push(`Sec-WebSocket-Protocol: ${O}`),x._protocol=O)}if(e[d.extensionName]){const O=e[d.extensionName].params,$=N.format({[d.extensionName]:[O]});S.push(`Sec-WebSocket-Extensions: ${$}`),x._extensions=e}this.emit("headers",S,s),l.write(S.concat(`\r
`).join(`\r
`)),l.removeListener("error",c),x.setSocket(l,L,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(x),x.on("close",()=>{this.clients.delete(x),this._shouldEmitClose&&!this.clients.size&&process.nextTick(h,this)})),C(x,s)}};D.exports=R;function w(e,n){for(const t of Object.keys(n))e.on(t,n[t]);return function(){for(const s of Object.keys(n))e.removeListener(s,n[s])}}function h(e){e._state=b,e.emit("close")}function c(){this.destroy()}function g(e,n,t,s){t=t||u.STATUS_CODES[n],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...s},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${n} ${u.STATUS_CODES[n]}\r
`+Object.keys(s).map(l=>`${l}: ${s[l]}`).join(`\r
`)+`\r
\r
`+t)}function k(e,n,t,s,l,L){if(e.listenerCount("wsClientError")){const C=new Error(l);Error.captureStackTrace(C,k),e.emit("wsClientError",C,t,n)}else g(t,s,l,L)}}}),Ae={};qe(Ae,{Receiver:()=>st.default,Sender:()=>it.default,WebSocket:()=>_e.default,WebSocketServer:()=>nt.default,createWebSocketStream:()=>rt.default,default:()=>ot});var rt=he(Qe()),st=he(Ie()),it=he(We()),_e=he(be()),nt=he(tt()),ot=_e.default;function at(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}var ft=(()=>{try{return at()}catch{return _e.default?_e.default:Ae}})();export{ft as WebSocket};
